# -*- coding: utf-8 -*-
"""Iris (Solved)

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1tz9qUx6hYwoA0tY1wjxGY9mSZcqr2l03
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import sklearn as sk
import math as m

from google.colab import drive
drive.mount('/gdrive')

path = '/gdrive/My Drive/ML:Pilot/Assignments/Data/'
rdata = pd.read_csv(path + 'Iris.csv')
rdata.head()

y = rdata['Species']
y = np.array(y)
y.reshape(-1,1)

x = rdata.drop(columns = ['Species'])
x.head()

from sklearn.model_selection import train_test_split, GridSearchCV
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, shuffle = True)
x_train.shape, y_train.shape, x_test.shape, y_test.shape

from sklearn.linear_model import LogisticRegression
parameters = {'solver': ('newton-cg', 'lbfgs', 'liblinear', 'sag', 'saga'), 'C':[0.00001,1]}
model = LogisticRegression(penalty = 'l2',n_jobs= -2, max_iter= 100000)
Grid = GridSearchCV(model,parameters)
Grid.fit(x_train,y_train)

train_pred = Grid.predict(x_train)

from sklearn.metrics import confusion_matrix
m = confusion_matrix(y_train, train_pred)
print(m)

import seaborn as sns
plt.figure(figsize=(9,9))
sns.heatmap(m, annot=True, fmt=".3f", linewidths=.5, square = True, cmap = 'Blues_r');
plt.ylabel('Actual label');
plt.xlabel('Predicted label');
all_sample_title = 'Training accuracy Score: {0}'.format(TrainScore)
plt.title(all_sample_title, size = 15);

TrainScore = Grid.score(x_train,y_train)
print(TrainScore)

#Test Data
pred_y = Grid.predict(x_test)

from sklearn.metrics import confusion_matrix
m = confusion_matrix(y_test, pred_y)
print(m)

TestScore = Grid.score(x_test,y_test)
print(TestScore)

import seaborn as sns
plt.figure(figsize=(9,9))
sns.heatmap(m, annot=True, fmt=".3f", linewidths=.5, square = True, cmap = 'Blues_r');
plt.ylabel('Actual label');
plt.xlabel('Predicted label');
all_sample_title = 'Test accuracy Score: {0}'.format(TestScore)
plt.title(all_sample_title, size = 15);

Grid.get_params

